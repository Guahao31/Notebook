# Operating Systems: Three Easy Pieces

[Free Web version](https://pages.cs.wisc.edu/~remzi/OSTEP/#book-chapters) By Remzi H. Arpaci-Dusseau and Andrea C. Arpaci-Dusseau, [code in repo](https://github.com/remzi-arpacidusseau/ostep-code).

> 本书从虚拟化、并发以及持久化这三个主题展开，介绍了绝大多数操作系统中的重要概念。

## CH02 引言

OS 负责什么？OS 作为软件保证**正确、高效地运行应用程序**，管理各种程序使用共享内存，管理程序与外设间的通信等。

### 虚拟化

虚拟化 CPU：在单核 CPU 上虚拟多道程序运行。OS 需要一些协议来保证程序的运行顺序，资源管理等。

虚拟化内存：主要问题是虚拟地址到物理地址的映射。每段程序有自己的一段虚拟地址空间，对于不同的程序，即使虚拟地址相同，也不意味着映射到同一物理地址上。

### 并发

当一个程序需要同时处理多个任务时，会产生**并发**。实际上 OS 本身就需要处理并发的问题。

### 持久化

内存设备如 DRAM 等通常是易失性的，断电后内部数据都会丢失，因此需要其他硬件来**持久地**保存一部分数据，即对一些数据进行持久化。

与 CPU 和内存不同，OS 并不会提供虚拟化的磁盘设备，因为通常情况下用户会想通过这些持久化的文件共享信息，而不是虚拟化后独自使用。

### 设计目标

需要构建一些功能的**抽象**来更简单地使用 OS 与设备。

希望能够设计实现**高性能**的 OS。希望尽可能地降低 OS 提供的如虚拟化的功能所带来的额外开销。

需要提供不同应用程序间的**隔离**（包括 OS 与应用程序之间）。

OS 需要更**可靠**，因为一旦 OS 崩溃，在其上运行的所有应用程序都会崩溃。

OS 还需要节能、保证安全性、可移动性等。

### 一些历史

一开始 OS 并不会负责很多功能，只提供一些最简单的库，如简单的 IO 接口，这时的 OS 通常只能运行一个程序，有专**人**负责对不同程序进行调度。这样的程序被称为**批处理**程序。

之后，人们认为应当区别看待 OS 与其他应用程序，因为 OS 通常能够接触到所有的设备等资源。这是什么 **system call** 的概念被引入，其他应用程序需要通过 system call 像 OS 请求处理，再由 OS 判断是否处理并执行、返回结果。

随着发展，OS 开始能够支持**多道程序**，可以将多个任务提到内存并在不同任务间进行切换，来实现看上去有多个程序在运行，提高了 CPU 的利用率。

个人计算机出现，逐渐形成了现代的、复杂的、高效处理程序运行的操作系统。